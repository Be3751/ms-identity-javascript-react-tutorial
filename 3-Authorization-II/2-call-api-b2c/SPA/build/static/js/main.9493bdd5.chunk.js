(this["webpackJsonpms-identity-react-c3s2"]=this["webpackJsonpms-identity-react-c3s2"]||[]).push([[0],{64:function(e,t,n){},87:function(e,t,n){},88:function(e,t,n){"use strict";n.r(t);var c=n(2),o=n.n(c),i=n(29),r=n.n(i),s=n(95),a=n(59),l=n(49),j={signUpSignIn:"B2C_1_signup-signin-jscom",forgotPassword:"B2C_1_reset-pw-jscom",editProfile:"B2C_1_edit_jscom"},d={signUpSignIn:{authority:"https://jcsampleb2c.b2clogin.com/jcsampleb2c.onmicrosoft.com/B2C_1_signup-signin-jscom"},forgotPassword:{authority:"https://jcsampleb2c.b2clogin.com/jcsampleb2c.onmicrosoft.com/B2C_1_reset-pw-jscom"},editProfile:{authority:"https://jcsampleb2c.b2clogin.com/jcsampleb2c.onmicrosoft.com/B2C_1_edit_jscom"}},u="jcsampleb2c.b2clogin.com",b={auth:{clientId:"e5d35d60-cf12-4781-8d55-b3ff3c73a802",authority:d.signUpSignIn.authority,knownAuthorities:[u],redirectUri:"/",postLogoutRedirectUri:"/",navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},system:{loggerOptions:{loggerCallback:function(e,t,n){if(!n)switch(e){case l.a.Error:return void console.error(t);case l.a.Info:return void console.info(t);case l.a.Verbose:return void console.debug(t);case l.a.Warning:return void console.warn(t)}}}}},h={apiHello:{endpoint:"http://localhost:5000/hello",scopes:["https://jcsampleb2c.onmicrosoft.com/tasks-api/tasks.read","https://jcsampleb2c.onmicrosoft.com/tasks-api/tasks.write"]}},p={scopes:Object(a.a)(h.apiHello.scopes)},f=n(16),O=n(71),g=n(23),m=n(9),x=n(3),v=n(96),k=n(97),w=n(67),y=n(94),P=n(72),C=n(7),S=function(){var e=Object(g.f)().instance;return Object(C.jsx)(C.Fragment,{children:Object(C.jsxs)(v.a,{bg:"primary",variant:"dark",children:[Object(C.jsx)("a",{className:"navbar-brand",href:"/",children:"Microsoft identity platform"}),Object(C.jsxs)(g.a,{children:[Object(C.jsx)(k.a.Link,{as:w.a,href:"/hello",children:"HelloAPI"}),Object(C.jsxs)("div",{className:"ml-auto",children:[Object(C.jsx)(w.a,{variant:"info",onClick:function(){return e.loginPopup(d.editProfile)},className:"ml-auto",children:"Edit Profile"}),Object(C.jsxs)(y.a,{variant:"warning",className:"ml-auto",drop:"left",title:"Sign Out",children:[Object(C.jsx)(P.a.Item,{as:"button",onClick:function(){return e.logoutPopup({postLogoutRedirectUri:"/",mainWindowRedirectUri:"/"})},children:"Sign out using Popup"}),Object(C.jsx)(P.a.Item,{as:"button",onClick:function(){return e.logoutRedirect({postLogoutRedirectUri:"/"})},children:"Sign out using Redirect"})]})]})]}),Object(C.jsx)(g.d,{children:Object(C.jsxs)(y.a,{variant:"secondary",className:"ml-auto",drop:"left",title:"Sign In",children:[Object(C.jsx)(P.a.Item,{as:"button",onClick:function(){e.loginPopup(p).catch((function(e){return console.log(e)}))},children:"Sign in using Popup"}),Object(C.jsx)(P.a.Item,{as:"button",onClick:function(){return e.loginRedirect(p)},children:"Sign in using Redirect"})]})})]})})},R=function(e){return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(S,{}),Object(C.jsx)("br",{}),Object(C.jsx)("h5",{children:Object(C.jsx)("center",{children:"Welcome to the Microsoft Authentication Library For React Tutorial"})}),Object(C.jsx)("br",{}),e.children,Object(C.jsx)("br",{}),Object(C.jsx)(g.a,{children:Object(C.jsx)("footer",{children:Object(C.jsxs)("center",{children:["How did we do?",Object(C.jsx)("a",{href:"https://forms.office.com/Pages/ResponsePage.aspx?id=v4j5cvGGr0GRqy180BHbR73pcsbpbxNJuZCMKN0lURpUMlRHSkc5U1NLUkxFNEtVN0dEOTFNQkdTWiQlQCN0PWcu",target:"_blank",children:" Share your experience!"})]})})})]})},_=n(26),I=n(35),T=n(31),N=n(25),U=n(37),E=function(){var e=Object(U.a)(Object(N.a)().mark((function e(t,n){var c,o,i;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=new Headers,o="Bearer ".concat(t),c.append("Authorization",o),i={method:"GET",headers:c},e.abrupt("return",fetch(n,i).then((function(e){return e.json()})).catch((function(e){return console.log(e)})));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),H=(n(64),function(e){var t=Object.entries(e.helloData).map((function(e,t){return Object(C.jsxs)("tr",{children:[Object(C.jsx)("td",{children:Object(C.jsxs)("b",{children:[e[0],": "]})}),Object(C.jsx)("td",{children:e[1]})]},t)}));return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsxs)("div",{className:"data-area-div",children:[Object(C.jsxs)("p",{children:["Calling ",Object(C.jsx)("strong",{children:"custom protected web API"}),"..."]}),Object(C.jsxs)("ul",{children:[Object(C.jsxs)("li",{children:[Object(C.jsx)("strong",{children:"endpoint:"})," ",Object(C.jsx)("mark",{children:h.apiHello.endpoint})]}),Object(C.jsxs)("li",{children:[Object(C.jsx)("strong",{children:"scope:"})," ",Object(C.jsx)("mark",{children:h.apiHello.scopes[0]})]})]}),Object(C.jsxs)("p",{children:["Contents of the ",Object(C.jsx)("strong",{children:"response"})," is below:"]})]}),Object(C.jsx)("div",{className:"data-area-div",children:Object(C.jsxs)("table",{children:[Object(C.jsx)("thead",{}),Object(C.jsx)("tbody",{children:t})]})})]})}),L=function(){var e=Object(g.f)(),t=e.instance,n=e.accounts,o=e.inProgress,i=Object(g.e)(n[0]||{}),r=Object(c.useState)(null),s=Object(I.a)(r,2),a=s[0],l=s[1];return Object(c.useEffect)((function(){i&&"none"===o&&!a&&t.acquireTokenSilent({scopes:h.apiHello.scopes,account:i}).then((function(e){E(e.accessToken,h.apiHello.endpoint).then((function(e){return l(e)}))})).catch((function(e){e instanceof T.a&&i&&"none"===o&&t.acquireTokenPopup({scopes:h.apiHello.scopes}).then((function(e){E(e.accessToken,h.apiHello.endpoint).then((function(e){return l(e)}))})).catch((function(e){return console.log(e)}))}))}),[i,o,t]),Object(C.jsx)(C.Fragment,{children:a?Object(C.jsx)(H,{helloData:a}):null})},A=function(){var e=Object(_.a)({},p);return Object(C.jsx)(g.b,{interactionType:x.k.Redirect,authenticationRequest:e,children:Object(C.jsx)(L,{})})},B=function(){var e=Object(g.f)().instance;return Object(c.useEffect)((function(){var t=e.addEventCallback((function(t){if(t.eventType===m.a.LOGIN_FAILURE&&t.error&&t.error.errorMessage.indexOf("AADB2C90118")>-1&&(t.interactionType===x.k.Redirect?e.loginRedirect(d.forgotPassword):t.interactionType===x.k.Popup&&e.loginPopup(d.forgotPassword).catch((function(e){}))),(t.eventType===m.a.LOGIN_SUCCESS||t.eventType===m.a.ACQUIRE_TOKEN_SUCCESS)&&null!==t&&void 0!==t&&t.payload){if(t.payload.idTokenClaims.acr===j.forgotPassword)return window.alert("Password has been reset successfully. \nPlease sign-in with your new password."),e.logout();if(t.payload.idTokenClaims.acr===j.editProfile)return window.alert("Profile has been edited successfully. \nPlease sign-in again."),e.logout()}}));return function(){t&&e.removeEventCallback(t)}}),[]),Object(C.jsx)(f.c,{children:Object(C.jsx)(f.a,{path:"/hello",children:Object(C.jsx)(A,{})})})},F=function(e){var t=e.instance;return Object(C.jsx)(O.a,{children:Object(C.jsx)(g.c,{instance:t,children:Object(C.jsx)(R,{children:Object(C.jsx)(B,{})})})})},G=(n(86),n(87),new s.a(b));r.a.render(Object(C.jsx)(o.a.StrictMode,{children:Object(C.jsx)(F,{instance:G})}),document.getElementById("root"))}},[[88,1,2]]]);
//# sourceMappingURL=main.9493bdd5.chunk.js.map